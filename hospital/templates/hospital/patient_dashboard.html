{% extends 'hospital/base.html' %}

{% block title %}Patient Dashboard - {{ patient.name }}{% endblock %}

{% block content %}
  <h2>Patient Dashboard</h2>
  <p>Welcome, {{ patient.name }}</p>

  <section style="margin-top:12px;">
    <h3>Book Appointment</h3>
    <form method="post" style="max-width:500px;">
      {% csrf_token %}
      <div style="margin-bottom:10px;">
        <label>Doctor:</label>
        {{ appointment_form.doctor }}
      </div>
      <div style="margin-bottom:10px;">
        <label>Date:</label>
        {{ appointment_form.appointment_date }}
      </div>
      <div style="margin-bottom:10px;">
        <label>Time:</label>
        {{ appointment_form.appointment_time }}
      </div>
      <div style="margin-bottom:10px;">
        <label>Message:</label>
        {{ appointment_form.message }}
      </div>
      <button type="submit" style="padding:8px 16px;background:#1976d2;color:#fff;border:none;border-radius:4px;">Book Appointment</button>
    </form>
  </section>

  <section style="margin-top:20px;">
    <h3>Your Appointments</h3>
    {% if appointments %}
      <ul>
        {% for a in appointments %}
          <li style="margin-bottom:10px;padding:10px;border:1px solid #ddd;border-radius:4px;">
            <strong>Doctor:</strong> {{ a.doctor.name }} ({{ a.doctor.specialization }})<br>
            <strong>Date & Time:</strong> {{ a.appointment_date }} at {{ a.appointment_time }}<br>
            {% if a.message %}
              <strong>Message:</strong> {{ a.message }}<br>
            {% endif %}
            <small style="color:#666;">Booked on: {{ a.created_at }}</small>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p>No appointments scheduled.</p>
    {% endif %}
  </section>

  <section style="margin-top:20px;">
    <h3>Your Prescriptions</h3>
    {% if prescriptions %}
      <ul>
        {% for p in prescriptions %}
          <li>
            <strong>From:</strong> {{ p.doctor.name }} â€” <strong>Medication:</strong> {{ p.medication }}
            <div style="font-size:0.9em;color:#555;">{{ p.created_at }}</div>
            {% if p.notes %}
              <div><em>Notes:</em> {{ p.notes }}</div>
            {% endif %}
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p>No prescriptions found.</p>
    {% endif %}
  </section>

{% endblock %}
